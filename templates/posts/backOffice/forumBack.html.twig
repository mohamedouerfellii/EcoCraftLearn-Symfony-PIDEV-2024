{% extends 'baseBack.html.twig' %}
{% block body %}
</br>
</br>
</br>
</br>
</br>

<!-- Admin Courses Tab Start -->
<div class="admin-courses-tab">
    <h3 class="title">Form</h3>
 
      
      <!-- /input-group -->
  
    <div class="courses-tab-wrapper">
        <div class="courses-select">
            <select>
                <option data-display="Newest First">Newest First</option>
                <option value="1">Oldest First</option>
            </select>
           
        </div>
        <ul class="nav">
            <li><button class="active" data-bs-toggle="tab" data-bs-target="#tab1"><i class="icofont-justify-left"></i></button></li>
            <li><button data-bs-toggle="tab" data-bs-target="#tab2"><i class="icofont-align-left"></i></button></li>
            <li><button data-bs-toggle="tab" data-bs-target="#tab3"><i class="icofont-eye-blocked"></i></button></li>
        </ul>
        
    </div>
</div>

<!-- Admin Courses Tab End -->

<!-- Admin Courses Tab Content Start -->
<div class="sidebar-search">
    <div class="input-group custom-search-form">
        <input type="text" id="search" class="form-control" placeholder="Search...">
    </div>
</div>

<div class="admin-courses-tab-content">
    <div class="tab-content">
        <div class="tab-pane fade show active" id="tab1">
            <table>
                <tbody id="search-results">
                    {% for post in posts %}
                        <tr>
                            <td>
                                <div class="post">
                                    <div class="post-header">
                                        <img src="{{ post.owner.image }}" class="profile-picture" alt="Profile Picture">
                                        <div class="post-info">
                                            <span class="post-author">{{ post.owner.firstname }}</span>
                                            <span class="post-time">{{ post.posteddate|date('y-m-d') }}</span>
                                        </div>
                                    </div>
                                    <div class="post-attachment">
                                        {% if post.attachment %}  
                                            <p><img src="{{ asset('contents/uploads/posts/' ~ post.attachment) }}" width="200px" height="200px"></p>
                                        {% endif %}
                                    </div>
                                    <div>
                                        <p>{{ post.content }}</p>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>










        </div>
        <div class="tab-pane fade" id="tab2">
        <!-- Courses Item Start -->
            <div class="courses-item">
                <div class="item-thumb">
                    <a href="#">
                        <img src="{{asset('assets/images/courses/admin-courses-01.jpg')}}" alt="Courses">
                    </a>
                </div>
                <div class="content-title">
                    <div class="meta">
                        <a href="#" class="action">Live</a>
                        <a href="#" class="action">Free</a>
                        <a href="#" class="action">Public</a>
                    </div>
                    <h3 class="title"><a href="#">Build An eCommerce Site With WooCommerce and WooLentor.</a></h3>
                </div>

                <div class="content-wrapper">

                    <div class="content-box">
                        <p>Earned</p>
                        <span class="count">$5,68.00</span>
                    </div>

                    <div class="content-box">
                        <p>Enrollment’s</p>
                        <span class="count">1,852</span>
                    </div>

                    <div class="content-box">
                        <p>Course Rating</p>
                        <span class="count">
                                4.5
                                <span class="rating-star">
                                    <span class="rating-bar" style="width: 80%;"></span>
                        </span>
                        </span>
                    </div>

                    <div class="courses-select">
                        <select>
                            <option data-display="This Month">This Month</option>
                            <option value="1">This Year</option>
                            <option value="2">This Week</option>
                        </select>
                    </div>

                </div>
            </div>
            <!-- Courses Item End -->

            <!-- Courses Item Start -->
            <div class="courses-item">
                <div class="item-thumb">
                    <a href="#">
                        <img src="{{asset('assets/images/courses/admin-courses-01.jpg')}}" alt="Courses">
                    </a>
                </div>

                <div class="content-title">
                    <div class="meta">
                        <a href="#" class="action">Live</a>
                        <a href="#" class="action">Free</a>
                        <a href="#" class="action">Public</a>
                    </div>
                    <h3 class="title"><a href="#">Build An eCommerce Site With WooCommerce and WooLentor.</a></h3>
                </div>

                <div class="content-wrapper">

                    <div class="content-box">
                        <p>Earned</p>
                        <span class="count">$5,68.00</span>
                    </div>

                    <div class="content-box">
                        <p>Enrollment’s</p>
                        <span class="count">1,852</span>
                    </div>

                    <div class="content-box">
                        <p>Course Rating</p>
                        <span class="count">
                                4.5
                                <span class="rating-star">
                                    <span class="rating-bar" style="width: 80%;"></span>
                        </span>
                        </span>
                    </div>

                    <div class="courses-select">
                        <select>
                            <option data-display="This Month">This Month</option>
                            <option value="1">This Year</option>
                            <option value="2">This Week</option>
                        </select>
                    </div>

                </div>
            </div>
            <!-- Courses Item End -->
        </div>
        <div class="tab-pane fade" id="tab3">

            <!-- Courses Item Start -->
            <div class="courses-item">
                <div class="item-thumb">
                    <a href="#">
                        <img src="{{asset('assets/images/courses/admin-courses-01.jpg')}}" alt="Courses">
                    </a>
                </div>

                <div class="content-title">
                    <div class="meta">
                        <a href="#" class="action">Live</a>
                        <a href="#" class="action">Free</a>
                        <a href="#" class="action">Public</a>
                    </div>
                    <h3 class="title"><a href="#">Build An eCommerce Site With WooCommerce and WooLentor.</a></h3>
                </div>

                <div class="content-wrapper">

                    <div class="content-box">
                        <p>Earned</p>
                        <span class="count">$5,68.00</span>
                    </div>

                    <div class="content-box">
                        <p>Enrollment’s</p>
                        <span class="count">1,852</span>
                    </div>

                    <div class="content-box">
                        <p>Course Rating</p>
                        <span class="count">
                                4.5
                                <span class="rating-star">
                                    <span class="rating-bar" style="width: 80%;"></span>
                        </span>
                        </span>
                    </div>

                    <div class="courses-select">
                        <select>
                            <option data-display="This Month">This Month</option>
                            <option value="1">This Year</option>
                            <option value="2">This Week</option>
                        </select>
                    </div>

                </div>
            </div>
            <!-- Courses Item End -->
        </div>
    </div>
</div>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script> 

<script>
    // Wait for the document to be fully loaded
    document.addEventListener("DOMContentLoaded", function() {
        // Select the search input field
        const searchInput = document.getElementById("search");

        // Select the search results container
        const searchResultsContainer = document.getElementById("search-results");

        // Add event listener for input event
        searchInput.addEventListener("input", function() {
            // Get the search query from the input field
            const query = searchInput.value;

            // Send an AJAX request to the server with the search query
            const xhr = new XMLHttpRequest();
            xhr.open("GET", `/search?q=${query}`, true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    // Parse the JSON response
                    const response = JSON.parse(xhr.responseText);
                    
                    // Clear the previous search results
                    searchResultsContainer.innerHTML = "";

                    // Loop through the entities in the response and create HTML elements
                   for (const [id, content] of Object.entries(response.entities)) {
    const post = document.createElement("div");
    post.classList.add("post");

    // Check if content.owner exists before accessing its properties
    const ownerImage = content.owner ? content.owner.image : '';
    const ownerFirstname = content.owner ? content.owner.firstname : '';
    const postedDate = content.posteddate ? content.posteddate : '';

    post.innerHTML = `
        <div class="post-header">
            ${ownerImage ? `<img src="${ownerImage}" class="profile-picture" alt="Profile Picture">` : ''}
            <div class="post-info">
                <span class="post-author">${ownerFirstname}</span>
                <span class="post-time">${postedDate}</span>
            </div>
        </div>
        <div class="post-attachment">
            ${content.attachment ? `<p><img src="contents/uploads/posts/${content.attachment}" width="200px" height="200px"></p>` : ""}
        </div>
        <div>
            <p>${content.content}</p>
        </div>
    `;
    searchResultsContainer.appendChild(post);
}
                }
            };
            xhr.send();
        });
    });
</script>
<!-- Admin Courses Tab Content End -->
{% endblock %}